# TwitchAdOverlay
Displays an overlay whenever a twitch ad is about to play. For use as an alternative to having to download and run Streamer.bot.

This code originally came from a widget made by [nutty](https://www.youtube.com/watch?v=e5B7ZNGtkac). While this code supports the old method of just using Streamer.bot via StreamElements, it can also be ran locally within OBS, avoiding the necessity of external programs and services. If you use the PubSub Twitch option, you cannot host the file as a StreamElements widget, as their CORS policy does not allow for connections to the Twitch backend.

## Setup

This will be going over how to run the system locally rather than via StreamElements and Streamer.bot. That setup is covered by the video nutty made.

1. Create a new application via [Twitch developer console](https://dev.twitch.tv/console). This will give you a client id that you will use later.
2. [Generate an OAuth token](https://twitchapps.com/tokengen/) for your new client id. You will need the following scopes: `channel:edit:commercial channel_commercial channel_read`
  **NOTE:** Make sure your redirect URL is properly set on the developer console.
4. Grant your new application a sign-in to your account.
5. Open `config_example.js` and modify the settings to your desired preferences.
7. Set the value for `twitchOAuthToken` to the new OAuth token that was generated by the tokengen website earlier.
8. Set the value of your client id in step 1 as `twitchClientId` in the settings file.
9. Set your channel username to the value of `twitchUserName`.
10. Make any other changes you wish to modify the general look and feel of things, but generally you don't have to do anything further.
11. Save the changes as `config.js`
12. Create a new browser scene in OBS, paste the URL to your html file.
13. You will now get ad overlays and a notification ding (remember to have your browser source also control audio through OBS and monitor that sound channel) whenever you get ads playing on your channel.


## Credits

* Ding sound from Free Sounds user LittleRainySeasons (public domain): https://freesound.org/people/LittleRainySeasons/sounds/335908/
* Original Streamer.Bot/StreamElements overlay code by: [nutty](https://www.youtube.com/@nuttylmao)
* PubSub event snooping by [TwitchLib](https://github.com/TwitchLib/TwitchLib.PubSub/blob/master/TwitchLib.PubSub/Models/Responses/Messages/VideoPlayback.cs#L12) and [twitch_api2](https://docs.rs/twitch_api2/0.6.1/src/twitch_api2/pubsub/video_playback.rs.html#14-17)
* IsNumeric from [this stackoverflow answer](https://stackoverflow.com/a/175787)
